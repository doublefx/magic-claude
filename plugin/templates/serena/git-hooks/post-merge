#!/bin/bash
# Git Hook: post-merge
# Logs merges/pulls with SHAs for git-sync agent impact analysis

BEFORE=$(git rev-parse ORIG_HEAD 2>/dev/null)
AFTER=$(git rev-parse HEAD 2>/dev/null)
COUNT=$(git rev-list --count "${BEFORE}..${AFTER}" 2>/dev/null || echo "?")

echo "[git-sync] Merged ${COUNT} commit(s). The git-sync agent will analyze impact."

LOG_FILE=".git/serena-sync-reminder.log"
echo "$(date -u '+%Y-%m-%d %H:%M:%S UTC') - post-merge before=${BEFORE} after=${AFTER} count=${COUNT}" >> "$LOG_FILE"
